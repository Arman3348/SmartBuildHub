{% extends 'homeownerbase.html' %}

{% block homeowner %}
<div class="row">
    <div class="col-sm-12">
        <h1 class="text-light">Application for {{project.projectname}}</h1>
    </div>
    <table class="table table-bordered table-stripped">
        <tr>
            <th class="text-light">S. No</th>
            <th class="text-light">Contractor Name</th>
            <th class="text-light">Design</th>
            <th class="text-light">Estimated Budget</th>
            <th class="text-light">Estimated Duration</th>
            <th class="text-light">Status</th>
            <th class="text-light">Submitted At</th>
            <th class="text-light">Actions</th>
        </tr>
        {% for a in applications %}
        <tr>
            <td class="text-light">{{ forloop.counter }}</td>
            <td class="text-light">{{ a.contractor.name }}</td>
            <td class="text-light">
                {% if a.design_file %}
                <a href="{{ a.design_file.url }}" class="btn btn-success" target="_blank">View Design</a>
                {% else %}
                No Design File
                {% endif %}
            </td>
            <td class="text-light">{{ a.estimated_budget }}</td>
            <td class="text-light">{{ a.estimated_duration }} Days</td>
            <td>
                {% if a.status == 'pending' %}
                <span class="btn btn-warning btn-sm">Pending</span>
                {% elif a.status == 'approved' %}
                <span class="btn btn-success btn-sm">Approved</span>
                {% elif a.status == 'rejected' %}
                <span class="btn btn-danger btn-sm">Rejected</span>
                {% else %}
                {{a.status}}
                {% endif %}
            </td>
            <td class="text-light">{{ a.submitted_at }}</td>
            <td class="text-light">
                {% if project.contractor %}
                Assigned to {{ project.contractor.name }}
                {% elif a.status == 'rejected' %}
                <span class="btn btn-danger">Rejected</span>
                {% elif a.status == 'approved' %}
                <span class="btn btn-success">Approved</span>
                {% else %}
                <a href="{% url 'approveapp' id=a.id %}" class="btn btn-success">Approved</a>
                <a href="{% url 'rejectedapp' id=a.id %}" class="btn btn-danger">Rejected</a>
                {% endif %}
            </td>

        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}